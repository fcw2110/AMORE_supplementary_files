function [Fitness]=Fitness_3(reference,test, iep1, iep2, isopn1, isopn2)
%org_nit = ["ISOP1OH2N";"ISOP1OH4N";"ISOP1N4OH";"ISOP3N4OH";"ISOP1CO2N3OOH4OH"; "ISOP1CO2OOH3N4OH"; "ISOP1OH2OOH3N4CO"; "ISOP1OH2N3OOH4CO"; "ISOP1OH2N3CO4OH"; "ISOP1CO2N3OOH4OOH"; "ISOP1CO2OOH3N4OOH"; "ISOP1CO2OOH3OOH4N"; "ISOP1OOH2OOH3N4CO"; "ISOP1OOH2N3OOH4CO"; "ISOP1N2OOH3OOH4CO"; "ISOP1OOH23O3OH4N"; "ISOP1N2OOH34O4OH"; "ISOP1OH12O3OOH4N"; "ISOP1OH2OOH3OH4N"; "ISOP1OH2N3OH4OOH"; "ISOP1N2OH3OOH4OH"; "ISOP1OOH2OH3N4OH"; "ISOP1OH2OOH3N4OH"; "ISOP1OH2N3OOH4OH"; "ISOP1N2OOH3OH4CO"; "ISOP1CO2OH3OOH4N"; "ISOP1OOH2OH3CO4N"; "ISOP1N4R4OH"; "ISOP1OH1R4N"; "ISOP3OH3R4N"; "ISOP1OOH2R3CO4N"; "ISOP1OH2OH3N4CO"; "ISOP1CO2N3OH4OH"; "ISOP1OH2N3R4OH"; "ISOP1OH2N3OH4N"; "ISOP1OH2N3N4OH"; "ISOP1CO2N3OH4OOH"; "ISOP1OH2R3N4OH"; "ISOP1N2OH3N4OH"; "ISOP1OOH2OH3N4CO"; "ISOP1N2OOH"; "ISOP1N4OOH"; "ISOP3OOH4N"; "ISOP1OOH4N"; "ISOP1N2OH"; "ISOP3CO4N"; "ISOP1CO4N"; "ISOP1O4N"; "ISOP1N4CO"; "ISOP1N4O"; "ISOP3OH4N"; "ISOP1N2N"; "ISOP1N4N"; "ISOP3N4N"; "ISOP1N253O4OH"; "ISOP1N253N4OH"; "ISOP1N253OOH4OH"; "ISOP1N253CO4OH"; "ISOP1N253OH4OH"; "ISOP1N2OOH3R4OH"; "ISOP1N23O4OH"; "ISOP1N2OH3R4OOH"; "ISOP1N2OH34O"; "ISOP1N2R3OH4OOH"; "ISOP1OH2R3OOH4N"; "ISOP1OH23O4N"; "ISOP1OOH2R3OH4N"; "ISOP12O3OH4N"; "ISOP1OOH2OH3R4N"; "ISOP1N2OOH3N4OH"; "ISOP1N2OOH3OOH4OH"; "ISOP1N2OOH3OH4N"; "ISOP1N2OOH3OH4OOH"; "ISOP1N2OH3N4OOH"; "ISOP1N2OH3OOH4OOH"; "ISOP1N2N3OH4OOH"; "ISOP1OH2N3OOH4N"; "ISOP1OH2OOH3OOH4N"; "ISOP1N2OH3OOH4N"; "ISOP1OOH2OH3OOH4N"; "ISOP1OOH2N3OH4N"; "ISOP1OOH2OOH3OH4N"; "ISOP1OO2OOH3OH4N"; "ISOP1N2N3OOH4OH"; "ISOP1OH2OOH3N4N"; "ISOP1N23O4OH4R"; "ISOP1N23O4CO"; "ISOP1OH1R23O4N"; "ISOP1CO23O4N"; "ISOP1N2OH3CO4OOH"; "ISOP12O3OH3R4N"; "ISOP12O3CO4N"; "ISOP1N2OH3CO4N"; "ISOP1OH2OOH3CO4N"; "ISOP1N4R4CO"; "ISOP1N4CO4OOH"; "ISOP1N4CO4OH"; "ISOP1CO1R4N"; "ISOP1CO1OOH4N"; "ISOP1CO1OH4N"; "ISOP1N2R3OH4CO"; "ISOP1CO2OH3R4N"; "ISOP1N2OH3OOH4CO"; "ISOP1CO2OOH3OH4N"; "ISOP1N2R3OH4OH"; "ISOP1OH2OH3R4N"; "ISOP1N2OOH3OH4OH"; "ISOP1OH2OH3OOH4N"; "ISOP1N2OH3OH4OOH"; "ISOP1OOH2OH3OH4N"; "ISOP1OOH2OH3N4N"; "ISOP1OH2N3CO4N"; "ISOP1N2N3CO4OH"; "ISOP1OH2OH3N4N"; "ISOP1N2OH3OH4N"; "ISOP1N2N3OH4OH"; "ISOP1CO2N3OH4N"; "ISOP1N2OH3N4CO"; "ISOP1N4PAN"; "ISOP1PAN4N";"ISOP1PAN4OH";"ISOP1OH4PAN"];
%iep1 = ["ISOP1OH23O4OHt"; "ISOP1OH23O4OHc"; "ISOP1OH2OH34O"]
%iep2 = ["IEPOXt"; "IEPOXc"; "IEPOXD"]
%nit_2= ["ISOP1OH2N"; "ISOP1OH4N";"ISOP1N4OH"; "ISOP3N4OH";"ISOPNOO1"; "ISOPNOO2"; "INO2B";"INO2D"; "INPB"; "INPD"; "ISOP1N4CO"; "ISOP1CO4N"; "ISOP3CO4N"; "IHNB"; "INO"; "IDN"; "IDHNBOO";"IDHNDOO1"; "IDHNDOO2"; "IHPNBOO"; "IHPNDOO"; "IHNE"; "ICNE"; "IHNEOO"; "ICN1OO"; "ICN2OO"; "ICN3OO";"ICN4OO"; "ICN5OO"; "ICHNP"; "IHNDP"; "IDHDN"; "IDHPN"; "IDHCN";"IHPDN"; "ICHDN"; "IHNPE";"MVK3CO4N";"MVK3OH4N"; "MVK3N4OH";"MVK3OOH4N"; "MACR2OOH3N"; "MACR2OH3N";"IDNOO"; "MACRNO2"; "MACRNOH"; "MACRNOOH"; "MPANHN"]
isop = ErrorCalc8_lumped(reference,test,"ISOP","ISOP");
ho = ErrorCalc8_lumped(reference,test,"HO","HO");
no = ErrorCalc8_lumped(reference,test,"NO","NO");
no2 = ErrorCalc8_lumped(reference,test,"NO2","NO2");
no3 = ErrorCalc8_lumped(reference,test,"NO3","NO3");
o3 = ErrorCalc8_lumped(reference,test,"O3","O3");
ho2 = ErrorCalc8_lumped(reference,test,"HO2","HO2");
mo2 = ErrorCalc8_lumped(reference,test,"MO2","MO2");
aco3 = ErrorCalc8_lumped(reference,test,"ACO3","ACO3");
pan = ErrorCalc8_lumped(reference,test,"PAN","PAN");
%mpan = ErrorCalc8_lumped(reference,test,"MPAN","MPAN");
iepox = ErrorCalc8_lumped(reference,test,iep1,iep2);
isopn = ErrorCalc8_lumped(reference,test,isopn1,isopn2);
hcho = ErrorCalc8_lumped(reference,test,"HCHO","HCHO");
%mvk = ErrorCalc8_lumped(reference,test,"MVK","MVK");
gly = ErrorCalc8_lumped(reference,test,"GLY","GLY");
%macr = ErrorCalc8_lumped(reference,test,"MACR","MACR");
mgly = ErrorCalc8_lumped(reference,test,"MGLY","MGLY");

%Fitness = 4*(no+no2+ho+ho2+no3+isop) + 3*(o3+mo2+aco3+pan) + 2*(iepox+hcho+isopn) + (mpan+gly+mvk+macr+mgly)
Fitness = ["IEPOX",iepox; "NO",no; "NO2",no2; "HO",ho; "HO2",ho2; "NO3",no3; "ISOP",isop; "O3",o3; "MO2",mo2; "ACO3",aco3; "PAN",pan; "HCHO",hcho; "ISOPN",isopn; "GLY",gly;"MGLY",mgly]
%Fitness = ["IEPOX",iepox; "NO",no; "NO2",no2; "HO",ho; "HO2",ho2; "NO3",no3; "ISOP",isop; "O3",o3; "MO2",mo2; "ACO3",aco3; "PAN",pan; "IEPOX",iepox; "HCHO",hcho; "ISOPN",isopn; "GLY",gly; "MVK" mvk; "MACR",macr; "MGLY",mgly]