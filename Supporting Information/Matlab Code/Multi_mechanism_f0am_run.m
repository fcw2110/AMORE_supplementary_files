clear
S = [];
samples = csvread('samples3.csv');
%important_species = ["ciHCHOO";"OH";"CH3OOH";"N2O5";"HNO3";"CH3NO3";"SO2";"O1D";"H2"; "O";"SO3";"CH3OONO2";"CH3O";"HONO";"SA";"HSO3";"NA";"HO2NO2";"O";"ISOP";"ISOP1OHt";"ISOP1OHc";"ISOP4OHt";"ISOP4OHc";"ISOP1OH2OO";"ISOP1OH4OOt";"ISOP1OH4OOc";"ISOP1OO4OHt";"ISOP1OO4OHc";"ISOP3OO4OH";"ISOP1OH2OOH";"ISOP3OOH4OH";"MVK";"MACR";"ISOP1CO4OH";"ISOP1OH4CO";"ISOP1OH2N";"ISOP1OH4Nc";"ISOP1OH4Nt";"ISOP3N4OH";"ISOP1N4OHc";"ISOP1N4OHt";"ISOP1CO2OOH3OO4OH";"ISOP1CO2OO3OOH4OH";"ISOP1CO2N3OOH4OH";"ISOP1CO2OOH3N4OH";"MVK3OOH4OH";"MGLY";"GLYC";"HCHO";"GLYX";"HAC";"ISOP1OH2OOH3OO4CO";"ISOP1OH2OO3OOH4CO";"ISOP1OH2OOH3N4CO";"ISOP1OH2N3OOH4CO";"ISOP1OH2OOH3OOH4CO";"ISOP1CO2OOH3OOH4OH";"MACR2OOH3OH";"MVK3OH4OH";"MACR3CO";"MACR2OH3OH";"ISOP3CO4OH";"ISOP1OH2OO3CO4OH";"MVK3CO4OH";"HPA";"ISOP1OH2N3CO4OH";"ISOP3OH4OH";"ISOP1OH2OH";"ISOP1OH2OOH3CO4OH";"ISOP1OH4OH";"CH3OO";"CH3OH";"ISOP1OOH4OHc";"ISOP1OH4OOHc";"ISOP1OOH4OHt";"ISOP1OH4OOHt";"ISOP1CO4OOHc";"ISOP1CO2R3OOH4OOH";"ISOP1CO2OO3OOH4OOH";"ISOP1CO23O4OOH";"ISOP1CO2OOH3OO4OOH";"ISOP1CO2OOH3OOH4OO";"MVK3OOH4OOH";"MVK3OOH4CO4OOH";"MACR2OOH3CO3OOH";"ISOP1CO2N3OOH4OOH";"HPETHNL";"ISOP1CO2OOH3N4OOH";"ISOP1CO2OOH3OOH4OOH";"ISOP1CO2OOH3OOH4N";"MACR2OOH3CO";"HCOOH";"ISOP1OOH4COc";"ISOP1OOH2OOH3R4CO";"ISOP1OOH2OOH3OO4CO";"ISOP1OOH23O4CO";"ISOP1OOH2OO3OOH4CO";"ISOP1OO2OOH3OOH4CO";"MACR2OOH3OOH";"ISOP1OOH2OOH3N4CO";"ISOP1OOH2OOH3OOH4CO";"ISOP1OOH2N3OOH4CO";"ISOP1N2OOH3OOH4CO";"ISOP1OOH23O3OH4N";"ISOP1N2OOH34O4OH";"ISOP1OH12O3OOH4N";"ISOP1CO2OOH3OOH4CO";"ISOP1OOH2OOH3CO4CO";"ISOP1CO2OOH34O4OH";"ISOP1OH12O3OOH4CO";"HPAC";"MVK3OOH4CO";"MVK3OO4OH";"MVK3OH4OO";"CH3CO3";"MVK3OOH4OH4OH";"MVK3OH4OOH";"MVK3N4OH";"MVK3N4OH4OH";"MVK3OH4N";"ETHLN";"MACR2OO3OH";"MACR2OH3OO";"MACR1OO";"MACR2OH3OOH";"MACR1OOH";"CH3COOCH2";"MACR1OH";"MACR2N3OH";"MACR2OH3N";"MPAN";"MPAN1OHx";"MPAN1OH2OO";"HMMLx";"MPAN1OH";"HMML";"MPAN1OH2O";"MPAN1OH2OOH";"ISOP1OH2OOH3R4OH";"ISOP1OH2OOH3OO4OH";"ISOP1OH23O4OHt";"ISOP1OH23O4OHc";"ISOP1OH2R3OOH4OH";"ISOP1OH2OO3OOH4OH";"ISOP12O3OH4OH";"ISOP1OH2OOH3OH4CO";"ISOP1OH2OOH3OH4OO";"ISOP1OH2OO3OH4OOH";"ISOP1OH2OOH3OH4N";"ISOP1OH2N3OH4OOH";"ISOP1OH2OOH3OH4OOH";"ISOP1OO2OH3OOH4OH";"ISOP1OOH2OH3CO4OH";"ISOP1OOH2OH34O4OH";"ISOP1OOH2OH3OO4OH";"ISOP1N2OH3OOH4OH";"ISOP1OOH2OH3N4OH";"ISOP1OOH2OH3OOH4OH";"ISOP1CO2OH3OOH4OH";"ISOP1OH2OOH3N4OH";"ISOP1OH2OOH3OOH4OH";"ISOP1OH12O3OOH4OH";"ISOP1OH12O3OH4OOH";"ISOP1OH2N3OOH4OH";"ISOP1OH2OOH34O4OH";"ISOP1N2OOH3OH4CO";"ISOP1CO2OH3OOH4N";"ISOP1OOH2OH3CO4N";"ISOP1N4R4OH";"ISOP1OH1R4N";"ISOP3OH3R4N";"ISOP1OOH2R3CO4N";"ISOP1N2OOH3OO4CO";"ISOP1N2OO3OOH4CO";"ISOP1CO2OO3OOH4N";"ISOP1CO2OOH3OO4N";"ISOP1CO2OOH";"ISO1OH12O";"ISOP3OOH4CO";"ISOP1OH23O4R4OHc";"ISOP1OH23O4CO";"ISOP1OH2OH3OO4CO";"ISOP1OH1R23O4OHc";"ISOP1CO23O4OH";"ISOP1CO2OO3OH4OH";"ISOP1OH23O4R4OHt";"ISOP1OH1R23O4OHt";"ISOP1OH2OH34O";"ISOP1CO2OH34O";"ISOP12O3OH4CO";"ISOP12O3OH3R4OH";"ISOP12O3CO4OH";"ISOP1OH3OH4CO";"ISOP1CO3OH4OH";"ISOP1OH2OH3N4CO";"ISOP1OH2OH3OOH4CO";"ISOP1CO2OOH3OH4OH";"ISOP1CO2N3OH4OH";"MVK3OH4CO";"MACR2OH3CO";"MVKENOL";"C4HVP1";"ISOP1CO4CO";"ISOP1CO2OO3OOH4CO";"MACRENOL";"C4HVP2";"ISOP1CO2OOH3OO4CO";"MVK3OO4OH4OH";"DHA";"PPYRAC";"PYRAC";"ciCH2OO";"ciMVKOO";"ciMACROO";"H2SO4";"HPMF";"HMHP";"H2O2";"MACR3OH3OOH";"MVK3OH3OOH";"FAH";"ISOP1CO4OOc";"ISOP1CO2OH3R4OOH";"ISOP1CO2OO3OH4OOH";"ISOP1CO2OOH3OH4CO";"ISOP1CO2OH3OO4OOH";"ISOP1OH2OOH3CO4CO";"ISOP1CO3R4OOH";"ISOP1CO2OH3OOH4OO";"ISOP1CO2OOH3OH4OO";"ISOP1CO2OO";"ISOP1OO4COc";"ISOP1OOH2OH3OO4CO";"ISOP1CO2OH3OOH4CO";"ISOP1OOH2OH3CO4CO";"ISOP1OOH2R3OH4CO";"ISOP1OOH2OO3OH4CO";"ISOP1OOH2R4CO";"ISOP1OO2OH3OOH4CO";"ISOP1OO2OOH3OH4CO";"ISOP3OO4CO";"ISOP1OH2N3R4OH";"ISOP1OH2N3OO4OH";"ISOP1OH2N3OH4OO";"ISOP1OH2N3OH4N";"ISOP1OH2N3N4OH";"ISOP1CO2N3OH4OOH";"ISOP1OH2R3N4OH";"ISOP1OH2OO3N4OH";"ISOP1OO2OH3N4OH";"ISOP1N2OH3N4OH";"ISOP1OOH2OH3N4CO";"ISOP1N2OO";"ISOP3OO4N";"ISOP1N4OO";"ISOP1OO4N";"ISOP1N2OOH";"ISOP1N4OOH";"ISOP3OOH4N";"ISOP1OOH4N";"ISOP1N2OOISOP1N2";"ISOP1N2OH";"ISOP3OO4NISOP1N2";"ISOP3CO4N";"ISOP1CO4N";"ISOP1O4N";"ISOP1OO4NISOP1N2";"ISOP1N4CO";"ISOP1N4O";"ISOP1N2OOISOP1N4";"ISOP1N4OOISOP1N4";"ISOP3OH4N";"ISOP3OO4NISOP1N4";"ISOP1OO4NISOP1N4";"ISOP1N2N";"ISOP1N4N";"ISOP3N4N";"ISOP1N253OO4OH";"ISOP1N253O4OH";"ISOP1N253N4OH";"MACR4N";"ISOP1N253OOH4OH";"ISOP1N253CO4OH";"ISOP1N253OH4OH";"ISOP1N253OO4OHISOP1N4";"ISOP1N253OO4OHISOP1N2";"ISOP1N2OOH3R4OH";"ISOP1N2OOH3OO4OH";"ISOP1N23O4OH";"ISOP1N2OOH3OH4OO";"ISOP1N2OH3R4OOH";"ISOP1N2OH3OO4OOH";"ISOP1N2OH34O";"ISOP1N2R3OH4OOH";"ISOP1N2OO3OH4OOH";"ISOP12O3OH4OOH";"ISOP1OH2R3OOH4N";"ISOP1OH2OO3OOH4N";"ISOP1OH23O4N";"ISOP1OO2OH3OOH4N";"ISOP1OOH2R3OH4N";"ISOP1OOH2OO3OH4N";"ISOP12O3OH4N";"ISOP1OOH2OH3R4N";"ISOP1OOH2OH3OO4N";"ISOP1OOH2OH34O";"ISOP1N2OOH3N4OH";"PROPNN";"MACR2OOH3N";"ISOP1N2OOH3OOH4OH";"ISOP1N2OOH3OH4N";"ISOP1N2OOH3OH4OOH";"ISOP1N2OH3N4OOH";"ISOP1N2OH3OOH4OOH";"ISOP1N2N3OH4OOH";"ISOP1OH2N3OOH4N";"MVK3OOH4N";"ISOP1OH2OOH3OOH4N";"ISOP1N2OH3OOH4N";"ISOP1OOH2OH3OOH4N";"ISOP1OOH2N3OH4N";"ISOP1OOH2OOH3OH4N";"ISOP1OOH2OH3N4N";"ISOP1N2OO3OOH4OH";"ISOP1N2OH3OOH4OO";"ISOP1OH2OOH3OO4N";"ISOP1OO2OOH3OH4N";"ISOP1N2N3OOH4OH";"ISOP1OH2OOH3N4N";"ISOP1N23O4OH4R";"ISOP1N23O4CO";"ISOP1N2OH3OO4CO";"ISOP1OH1R23O4N";"ISOP1CO23O4N";"ISOP1CO2OO3OH4N";"ISOP1N2OH3CO4OO";"ISOP1N2OH3CO4OOH";"ISOP12O3OH3R4N";"ISOP12O3CO4N";"ISOP1OH2OO3CO4N";"ISOP1N2OH3CO4N";"ISOP1OH2OOH3CO4N";"NPA";"MVK3CO4N";"ISOP1OH2N3CO4N";"ISOP1N2OO3CO4OH";"ISOP1N2N3CO4OH";"ISOP1N4R4CO";"ISOP1N4CO4OO";"ISOP1N4PAN";"C4NVP2";"ISOP1N4CO4OOH";"ISOP1N4CO4OH";"MACR2OO3N";"MACR2N3N";"ISOP1CO1R4N";"ISOP1CO1OO4N";"ISOP1PAN4N";"C4NVP1";"ISOP1CO1OOH4N";"ISOP1CO1OH4N";"MVK3OO4N";"MVK3N4N";"ISOP1N2R3OH4CO";"ISOP1N2OO3OH4CO";"ISOP1CO2OH3R4N";"ISOP1CO2OH3OO4N";"ISOP1N2OH3OOH4CO";"ISOP1N2OH3N4CO";"ISOP1CO2OOH3OH4N";"ISOP1CO2N3OH4N";"ISOP1N2OH3OO4OH";"ISOP1N2OH3OH4OO";"ISOP1N2R3OH4OH";"ISOP1N2OO3OH4OH";"ISOP1OH2OO3OH4N";"ISOP1OO2OH3OH4N";"ISOP1OH2OH3R4N";"ISOP1OH2OH3OO4N";"ISOP1N2OOH3OH4OH";"ISOP1OH2OH3OOH4N";"ISOP1N2N3OH4OH";"ISOP1OH2OH3N4N";"ISOP1N2OH3OH4OOH";"ISOP1OOH2OH3OH4N";"ISOP1N2OH3OH4N";"ISOP1CO1OO4OOH";"ISOP1CO1OOH4OO";"ISOP1CO1OOH2OO";"ISOP1CO1OOH";"ISOP4CO4OOH";"ISOP1OOH4CO4OO";"ISOP1OO4CO4OOH";"ISOP3OO4CO4OOH";"ISOP1CO1R4OH";"ISOP1OH4CO4R";"ISOP1CO1OO4OH";"ISOP1OH4CO4OO";"ISOP1PAN4OH";"ISOP1OH4PAN";"ISOP1CO1OH4OH";"ISOP1OH4CO4OH";"ISOP1CO1OOH4OH";"ISOP1OH4CO4OOH";"HOCH2COCHO";"HOCH2CO3";"NO3CH2CO2H";"NPAH";"NO3CH2PAN";"HOCH2CO2H";"HOCH2CO3H";"PHAN";"IDHNBOO";"IDNOO";"MACRNOOH";"MACRNOH";"IHNEOO";"NCH2CO3H";"NCH2CO3";"CH3CO2H";"CH3CO3H";"PAN";"MPANH";"MPANHN";"NCH2CO2H";"PNAN";"MACRNO2";"CO";"CO2";"M";"O2";"OH";"HO2";"NO";"NO2";"NO3";"MO2";"H2O";"H2Od";"O3";"SO2"]
N = [];
A = ["m" "s"]
Lm = length(samples);
runs = ["cb6r3_ae7_aqAllRxns_HO_HCHO","Caltech_full","AMORE","Caltech_reduced_plus","CRACMM"];%["f0am_full_1_10_fold_iepox_aco3_gly_ac_pan_mpan_iepox2_ihn", "f0am_skel_good_cracmm_fold_FINAL_update_5","CRACMM_j_edit_isop_panin_edit"]
%runs = ["f0am_caltech_complete_v1","f0am_v4_con_800","f0am_v4_con_600","f0am_v4_con_400","f0am_v4_con_250","f0am_v4_con_200","f0am_v4_con_150","f0am_v4_con_100","f0am_v4_sum_800","f0am_v4_sum_600","f0am_v4_sum_400","f0am_v4_sum_250","f0am_v4_sum_200","f0am_v4_sum_150","f0am_v4_sum_100","f0am_v4_prod_800","f0am_v4_prod_600","f0am_v4_prod_400","f0am_v4_prod_250","f0am_v4_prod_200","f0am_v4_prod_150","f0am_v4_prod_100"];
org_nit = ["ISOP1CO2N3OOH4OH"; "ISOP1CO2OOH3N4OH"; "ISOP1OH2OOH3N4CO"; "ISOP1OH2N3OOH4CO"; "ISOP1OH2N3CO4OH"; "ISOP1CO2N3OOH4OOH"; "ISOP1CO2OOH3N4OOH"; "ISOP1CO2OOH3OOH4N"; "ISOP1OOH2OOH3N4CO"; "ISOP1OOH2N3OOH4CO"; "ISOP1N2OOH3OOH4CO"; "ISOP1OOH23O3OH4N"; "ISOP1N2OOH34O4OH"; "ISOP1OH12O3OOH4N"; "ISOP1OH2OOH3OH4N"; "ISOP1OH2N3OH4OOH"; "ISOP1N2OH3OOH4OH"; "ISOP1OOH2OH3N4OH"; "ISOP1OH2OOH3N4OH"; "ISOP1OH2N3OOH4OH"; "ISOP1N2OOH3OH4CO"; "ISOP1CO2OH3OOH4N"; "ISOP1OOH2OH3CO4N"; "ISOP1N4R4OH"; "ISOP1OH1R4N"; "ISOP3OH3R4N"; "ISOP1OOH2R3CO4N"; "ISOP1OH2OH3N4CO"; "ISOP1CO2N3OH4OH"; "ISOP1OH2N3R4OH"; "ISOP1OH2N3OH4N"; "ISOP1OH2N3N4OH"; "ISOP1CO2N3OH4OOH"; "ISOP1OH2R3N4OH"; "ISOP1N2OH3N4OH"; "ISOP1OOH2OH3N4CO"; "ISOP1N2OOH"; "ISOP1N4OOH"; "ISOP3OOH4N"; "ISOP1OOH4N"; "ISOP1N2OH"; "ISOP3CO4N"; "ISOP1CO4N"; "ISOP1O4N"; "ISOP1N4CO"; "ISOP1N4O"; "ISOP3OH4N"; "ISOP1N2N"; "ISOP1N4N"; "ISOP3N4N"; "ISOP1N253O4OH"; "ISOP1N253N4OH"; "ISOP1N253OOH4OH"; "ISOP1N253CO4OH"; "ISOP1N253OH4OH"; "ISOP1N2OOH3R4OH"; "ISOP1N23O4OH"; "ISOP1N2OH3R4OOH"; "ISOP1N2OH34O"; "ISOP1N2R3OH4OOH"; "ISOP1OH2R3OOH4N"; "ISOP1OH23O4N"; "ISOP1OOH2R3OH4N"; "ISOP12O3OH4N"; "ISOP1OOH2OH3R4N"; "ISOP1N2OOH3N4OH"; "ISOP1N2OOH3OOH4OH"; "ISOP1N2OOH3OH4N"; "ISOP1N2OOH3OH4OOH"; "ISOP1N2OH3N4OOH"; "ISOP1N2OH3OOH4OOH"; "ISOP1N2N3OH4OOH"; "ISOP1OH2N3OOH4N"; "ISOP1OH2OOH3OOH4N"; "ISOP1N2OH3OOH4N"; "ISOP1OOH2OH3OOH4N"; "ISOP1OOH2N3OH4N"; "ISOP1OOH2OOH3OH4N"; "ISOP1OO2OOH3OH4N"; "ISOP1N2N3OOH4OH"; "ISOP1OH2OOH3N4N"; "ISOP1N23O4OH4R"; "ISOP1N23O4CO"; "ISOP1OH1R23O4N"; "ISOP1CO23O4N"; "ISOP1N2OH3CO4OOH"; "ISOP12O3OH3R4N"; "ISOP12O3CO4N"; "ISOP1N2OH3CO4N"; "ISOP1OH2OOH3CO4N"; "ISOP1N4R4CO"; "ISOP1N4CO4OOH"; "ISOP1N4CO4OH"; "ISOP1CO1R4N"; "ISOP1CO1OOH4N"; "ISOP1CO1OH4N"; "ISOP1N2R3OH4CO"; "ISOP1CO2OH3R4N"; "ISOP1N2OH3OOH4CO"; "ISOP1CO2OOH3OH4N"; "ISOP1N2R3OH4OH"; "ISOP1OH2OH3R4N"; "ISOP1N2OOH3OH4OH"; "ISOP1OH2OH3OOH4N"; "ISOP1N2OH3OH4OOH"; "ISOP1OOH2OH3OH4N"; "ISOP1OOH2OH3N4N"; "ISOP1OH2N3CO4N"; "ISOP1N2N3CO4OH"; "ISOP1OH2OH3N4N"; "ISOP1N2OH3OH4N"; "ISOP1N2N3OH4OH"; "ISOP1CO2N3OH4N"; "ISOP1N2OH3N4CO"; "ISOP1N4PAN"; "ISOP1PAN4N";"ISOP1PAN4OH";"ISOP1OH4PAN"];
nit = 'ISOP1CO2N3OOH4OH+ISOP1CO2OOH3N4OH+ISOP1OH2OOH3N4CO+ISOP1OH2N3OOH4CO+ISOP1OH2N3CO4OH+ISOP1CO2N3OOH4OOH+ISOP1CO2OOH3N4OOH+ISOP1CO2OOH3OOH4N+ISOP1OOH2OOH3N4CO+ISOP1OOH2N3OOH4CO+ISOP1N2OOH3OOH4CO+ISOP1OOH23O3OH4N+ISOP1N2OOH34O4OH+ISOP1OH12O3OOH4N+ISOP1OH2OOH3OH4N+ISOP1OH2N3OH4OOH+ISOP1N2OH3OOH4OH+ISOP1OOH2OH3N4OH+ISOP1OH2OOH3N4OH+ISOP1OH2N3OOH4OH+ISOP1N2OOH3OH4CO+ISOP1CO2OH3OOH4N+ISOP1OOH2OH3CO4N+ISOP1N4R4OH+ISOP1OH1R4N+ISOP3OH3R4N+ISOP1OOH2R3CO4N+ISOP1OH2OH3N4CO+ISOP1CO2N3OH4OH+ISOP1OH2N3R4OH+ISOP1OH2N3OH4N+ISOP1OH2N3N4OH+ISOP1CO2N3OH4OOH+ISOP1OH2R3N4OH+ISOP1N2OH3N4OH+ISOP1OOH2OH3N4CO+ISOP1N2OOH+ISOP1N4OOH+ISOP3OOH4N+ISOP1OOH4N+ISOP1N2OH+ISOP3CO4N+ISOP1CO4N+ISOP1O4N+ISOP1N4CO+ISOP1N4O+ISOP3OH4N+ISOP1N2N+ISOP1N4N+ISOP3N4N+ISOP1N253O4OH+ISOP1N253N4OH+ISOP1N253OOH4OH+ISOP1N253CO4OH+ISOP1N253OH4OH+ISOP1N2OOH3R4OH+ISOP1N23O4OH+ISOP1N2OH3R4OOH+ISOP1N2OH34O+ISOP1N2R3OH4OOH+ISOP1OH2R3OOH4N+ISOP1OH23O4N+ISOP1OOH2R3OH4N+ISOP12O3OH4N+ISOP1OOH2OH3R4N+ISOP1N2OOH3N4OH+ISOP1N2OOH3OOH4OH+ISOP1N2OOH3OH4N+ISOP1N2OOH3OH4OOH+ISOP1N2OH3N4OOH+ISOP1N2OH3OOH4OOH+ISOP1N2N3OH4OOH+ISOP1OH2N3OOH4N+ISOP1OH2OOH3OOH4N+ISOP1N2OH3OOH4N+ISOP1OOH2OH3OOH4N+ISOP1OOH2N3OH4N+ISOP1OOH2OOH3OH4N+ISOP1OO2OOH3OH4N+ISOP1N2N3OOH4OH+ISOP1OH2OOH3N4N+ISOP1N23O4OH4R+ISOP1N23O4CO+ISOP1OH1R23O4N+ISOP1CO23O4N+ISOP1N2OH3CO4OOH+ISOP12O3OH3R4N+ISOP12O3CO4N+ISOP1N2OH3CO4N+ISOP1OH2OOH3CO4N+ISOP1N4R4CO+ISOP1N4CO4OOH+ISOP1N4CO4OH+ISOP1CO1R4N+ISOP1CO1OOH4N+ISOP1CO1OH4N+ISOP1N2R3OH4CO+ISOP1CO2OH3R4N+ISOP1N2OH3OOH4CO+ISOP1CO2OOH3OH4N+ISOP1N2R3OH4OH+ISOP1OH2OH3R4N+ISOP1N2OOH3OH4OH+ISOP1OH2OH3OOH4N+ISOP1N2OH3OH4OOH+ISOP1OOH2OH3OH4N+ISOP1OOH2OH3N4N+ISOP1OH2N3CO4N+ISOP1N2N3CO4OH+ISOP1OH2OH3N4N+ISOP1N2OH3OH4N+ISOP1N2N3OH4OH+ISOP1CO2N3OH4N+ISOP1N2OH3N4CO+ISOP1N4PAN+ISOP1PAN4N+ISOP1PAN4OH+ISOP1OH4PAN';
nit ='ISOP1OH2N+ISOP1OH4N+ISOP1N4OH+ISOP3N4OH+ISOP1CO2N3OOH4OH+ISOP1CO2OOH3N4OH+ISOP1OH2OOH3N4CO+ISOP1OH2N3OOH4CO+ISOP1OH2N3CO4OH+ISOP1CO2N3OOH4OOH+ISOP1CO2OOH3N4OOH+ISOP1CO2OOH3OOH4N+ISOP1OOH2OOH3N4CO+ISOP1OOH2N3OOH4CO+ISOP1N2OOH3OOH4CO+ISOP1OOH23O3OH4N+ISOP1N2OOH34O4OH+ISOP1OH12O3OOH4N+ISOP1OH2OOH3OH4N+ISOP1OH2N3OH4OOH+ISOP1N2OH3OOH4OH+ISOP1OOH2OH3N4OH+ISOP1OH2OOH3N4OH+ISOP1OH2N3OOH4OH+ISOP1N2OOH3OH4CO+ISOP1CO2OH3OOH4N+ISOP1OOH2OH3CO4N+ISOP1N4R4OH+ISOP1OH1R4N+ISOP3OH3R4N+ISOP1OOH2R3CO4N+ISOP1OH2OH3N4CO+ISOP1CO2N3OH4OH+ISOP1OH2N3R4OH+ISOP1OH2N3OH4N+ISOP1OH2N3N4OH+ISOP1CO2N3OH4OOH+ISOP1OH2R3N4OH+ISOP1N2OH3N4OH+ISOP1OOH2OH3N4CO+ISOP1N2OOH+ISOP1N4OOH+ISOP3OOH4N+ISOP1OOH4N+ISOP1N2OH+ISOP3CO4N+ISOP1CO4N+ISOP1O4N+ISOP1N4CO+ISOP1N4O+ISOP3OH4N+ISOP1N2N+ISOP1N4N+ISOP3N4N+ISOP1N253O4OH+ISOP1N253N4OH+ISOP1N253OOH4OH+ISOP1N253CO4OH+ISOP1N253OH4OH+ISOP1N2OOH3R4OH+ISOP1N23O4OH+ISOP1N2OH3R4OOH+ISOP1N2OH34O+ISOP1N2R3OH4OOH+ISOP1OH2R3OOH4N+ISOP1OH23O4N+ISOP1OOH2R3OH4N+ISOP12O3OH4N+ISOP1OOH2OH3R4N+ISOP1N2OOH3N4OH+ISOP1N2OOH3OOH4OH+ISOP1N2OOH3OH4N+ISOP1N2OOH3OH4OOH+ISOP1N2OH3N4OOH+ISOP1N2OH3OOH4OOH+ISOP1N2N3OH4OOH+ISOP1OH2N3OOH4N+ISOP1OH2OOH3OOH4N+ISOP1N2OH3OOH4N+ISOP1OOH2OH3OOH4N+ISOP1OOH2N3OH4N+ISOP1OOH2OOH3OH4N+ISOP1OO2OOH3OH4N+ISOP1N2N3OOH4OH+ISOP1OH2OOH3N4N+ISOP1N23O4OH4R+ISOP1N23O4CO+ISOP1OH1R23O4N+ISOP1CO23O4N+ISOP1N2OH3CO4OOH+ISOP12O3OH3R4N+ISOP12O3CO4N+ISOP1N2OH3CO4N+ISOP1OH2OOH3CO4N+ISOP1N4R4CO+ISOP1N4CO4OOH+ISOP1N4CO4OH+ISOP1CO1R4N+ISOP1CO1OOH4N+ISOP1CO1OH4N+ISOP1N2R3OH4CO+ISOP1CO2OH3R4N+ISOP1N2OH3OOH4CO+ISOP1CO2OOH3OH4N+ISOP1N2R3OH4OH+ISOP1OH2OH3R4N+ISOP1N2OOH3OH4OH+ISOP1OH2OH3OOH4N+ISOP1N2OH3OH4OOH+ISOP1OOH2OH3OH4N+ISOP1OOH2OH3N4N+ISOP1OH2N3CO4N+ISOP1N2N3CO4OH+ISOP1OH2OH3N4N+ISOP1N2OH3OH4N+ISOP1N2N3OH4OH+ISOP1CO2N3OH4N+ISOP1N2OH3N4CO+ISOP1N4PAN+ISOP1PAN4N+ISOP1PAN4OH+ISOP1OH4PAN';
%nit2 = 'ISOP1OH2N+ISOP1OH4N + ISOP1N4OH +  ISOP3N4OH + ISOPNOO1 +  ISOPNOO2 +  INO2B + INO2D +  INPB +  INPD +  ISOP1N4CO +  ISOP1CO4N +  ISOP3CO4N +  IHNB +  INO +  IDN +  IDHNBOO + IDHNDOO1 +  IDHNDOO2 +  IHPNBOO +  IHPNDOO +  IHNE +  ICNE +  IHNEOO +  ICN1OO +  ICN2OO +  ICN3OO + ICN4OO +  ICN5OO +  ICHNP +  IHNDP +  IDHDN +  IDHPN +  IDHCN + IHPDN +  ICHDN +  IHNPE + MVK3CO4N + MVK3OH4N +  MVK3N4OH + MVK3OOH4N +  MACR2OOH3N +  MACR2OH3N + IDNOO +  MACRNO2 +  MACRNOH +  MACRNOOH +  MPANHN'
nit2 = 'ISOP1OH2N+ISOP1OH4N + ISOP1N4OH +  ISOP3N4OH + ISOPNOO1 +  ISOPNOO2 +  INO2B + INO2D +  INPB +  INPD +  ISOP1N4CO +  ISOP1CO4N +  ISOP3CO4N +  IHNB +  INO +  IDN +  IDHNBOO + IDHNDOO1 +  IDHNDOO2 +  IHPNBOO +  IHPNDOO +  IHNE +  ICNE +  IHNEOO +  ICN1OO +  ICN2OO +  ICN3OO + ICN4OO +  ICN5OO +  ICHNP +  IHNDP +  IDHDN +  IDHPN +  IDHCN + IHPDN +  ICHDN +  IHNPE + IDNOO'
IEPO = 'IEPOXt + IEPOXc + IEPOXD'
IEP  = 'ISOP1OH23O4OHt + ISOP1OH23O4OHc + ISOP1OH2OH34O'
Lr = length(runs);
org_nit = ["ISOP1OH2N";"ISOP1OH4N";"ISOP1N4OH";"ISOP3N4OH";"ISOP1CO2N3OOH4OH"; "ISOP1CO2OOH3N4OH"; "ISOP1OH2OOH3N4CO"; "ISOP1OH2N3OOH4CO"; "ISOP1OH2N3CO4OH"; "ISOP1CO2N3OOH4OOH"; "ISOP1CO2OOH3N4OOH"; "ISOP1CO2OOH3OOH4N"; "ISOP1OOH2OOH3N4CO"; "ISOP1OOH2N3OOH4CO"; "ISOP1N2OOH3OOH4CO"; "ISOP1OOH23O3OH4N"; "ISOP1N2OOH34O4OH"; "ISOP1OH12O3OOH4N"; "ISOP1OH2OOH3OH4N"; "ISOP1OH2N3OH4OOH"; "ISOP1N2OH3OOH4OH"; "ISOP1OOH2OH3N4OH"; "ISOP1OH2OOH3N4OH"; "ISOP1OH2N3OOH4OH"; "ISOP1N2OOH3OH4CO"; "ISOP1CO2OH3OOH4N"; "ISOP1OOH2OH3CO4N"; "ISOP1N4R4OH"; "ISOP1OH1R4N"; "ISOP3OH3R4N"; "ISOP1OOH2R3CO4N"; "ISOP1OH2OH3N4CO"; "ISOP1CO2N3OH4OH"; "ISOP1OH2N3R4OH"; "ISOP1OH2N3OH4N"; "ISOP1OH2N3N4OH"; "ISOP1CO2N3OH4OOH"; "ISOP1OH2R3N4OH"; "ISOP1N2OH3N4OH"; "ISOP1OOH2OH3N4CO"; "ISOP1N2OOH"; "ISOP1N4OOH"; "ISOP3OOH4N"; "ISOP1OOH4N"; "ISOP1N2OH"; "ISOP3CO4N"; "ISOP1CO4N"; "ISOP1O4N"; "ISOP1N4CO"; "ISOP1N4O"; "ISOP3OH4N"; "ISOP1N2N"; "ISOP1N4N"; "ISOP3N4N"; "ISOP1N253O4OH"; "ISOP1N253N4OH"; "ISOP1N253OOH4OH"; "ISOP1N253CO4OH"; "ISOP1N253OH4OH"; "ISOP1N2OOH3R4OH"; "ISOP1N23O4OH"; "ISOP1N2OH3R4OOH"; "ISOP1N2OH34O"; "ISOP1N2R3OH4OOH"; "ISOP1OH2R3OOH4N"; "ISOP1OH23O4N"; "ISOP1OOH2R3OH4N"; "ISOP12O3OH4N"; "ISOP1OOH2OH3R4N"; "ISOP1N2OOH3N4OH"; "ISOP1N2OOH3OOH4OH"; "ISOP1N2OOH3OH4N"; "ISOP1N2OOH3OH4OOH"; "ISOP1N2OH3N4OOH"; "ISOP1N2OH3OOH4OOH"; "ISOP1N2N3OH4OOH"; "ISOP1OH2N3OOH4N"; "ISOP1OH2OOH3OOH4N"; "ISOP1N2OH3OOH4N"; "ISOP1OOH2OH3OOH4N"; "ISOP1OOH2N3OH4N"; "ISOP1OOH2OOH3OH4N"; "ISOP1OO2OOH3OH4N"; "ISOP1N2N3OOH4OH"; "ISOP1OH2OOH3N4N"; "ISOP1N23O4OH4R"; "ISOP1N23O4CO"; "ISOP1OH1R23O4N"; "ISOP1CO23O4N"; "ISOP1N2OH3CO4OOH"; "ISOP12O3OH3R4N"; "ISOP12O3CO4N"; "ISOP1N2OH3CO4N"; "ISOP1OH2OOH3CO4N"; "ISOP1N4R4CO"; "ISOP1N4CO4OOH"; "ISOP1N4CO4OH"; "ISOP1CO1R4N"; "ISOP1CO1OOH4N"; "ISOP1CO1OH4N"; "ISOP1N2R3OH4CO"; "ISOP1CO2OH3R4N"; "ISOP1N2OH3OOH4CO"; "ISOP1CO2OOH3OH4N"; "ISOP1N2R3OH4OH"; "ISOP1OH2OH3R4N"; "ISOP1N2OOH3OH4OH"; "ISOP1OH2OH3OOH4N"; "ISOP1N2OH3OH4OOH"; "ISOP1OOH2OH3OH4N"; "ISOP1OOH2OH3N4N"; "ISOP1OH2N3CO4N"; "ISOP1N2N3CO4OH"; "ISOP1OH2OH3N4N"; "ISOP1N2OH3OH4N"; "ISOP1N2N3OH4OH"; "ISOP1CO2N3OH4N"; "ISOP1N2OH3N4CO"; "ISOP1N4PAN"; "ISOP1PAN4N";"ISOP1PAN4OH";"ISOP1OH4PAN"];
iep1 = ["ISOP1OH23O4OHt"; "ISOP1OH23O4OHc"; "ISOP1OH2OH34O"];
iep2 = ["IEPOXt"; "IEPOXc"; "IEPOXD"];
%nit_2= ["ISOP1OH2N"; "ISOP1OH4N";"ISOP1N4OH"; "ISOP3N4OH";"ISOPNOO1"; "ISOPNOO2"; "INO2B";"INO2D"; "INPB"; "INPD"; "ISOP1N4CO"; "ISOP1CO4N"; "ISOP3CO4N"; "IHNB"; "INO"; "IDN"; "IDHNBOO";"IDHNDOO1"; "IDHNDOO2"; "IHPNBOO"; "IHPNDOO"; "IHNE"; "ICNE"; "IHNEOO"; "ICN1OO"; "ICN2OO"; "ICN3OO";"ICN4OO"; "ICN5OO"; "ICHNP"; "IHNDP"; "IDHDN"; "IDHPN"; "IDHCN";"IHPDN"; "ICHDN"; "IHNPE";"MVK3CO4N";"MVK3OH4N"; "MVK3N4OH";"MVK3OOH4N"; "MACR2OOH3N"; "MACR2OH3N";"IDNOO"; "MACRNO2"; "MACRNOH"; "MACRNOOH"; "MPANHN"];
nit_2= ["ISOP1OH2N"; "ISOP1OH4N";"ISOP1N4OH"; "ISOP3N4OH";"ISOPNOO1"; "ISOPNOO2"; "INO2B";"INO2D"; "INPB"; "INPD"; "ISOP1N4CO"; "ISOP1CO4N"; "ISOP3CO4N"; "IHNB"; "INO"; "IDN"; "IDHNBOO";"IDHNDOO1"; "IDHNDOO2"; "IHPNBOO"; "IHPNDOO"; "IHNE"; "ICNE"; "IHNEOO"; "ICN1OO"; "ICN2OO"; "ICN3OO";"ICN4OO"; "ICN5OO"; "ICHNP"; "IHNDP"; "IDHDN"; "IDHPN"; "IDHCN";"IHPDN"; "ICHDN"; "IHNPE";"IDNOO"];

%P = ["MECH" "ISOP" "HCHO" "MVK" "GLYX" "MACR" "MGLY" "PANS" "ISOPN" "MPANS" "IEPOX"];
%Y = ["T2" "T3" "T4" "T5" "T6" "T7" "T8" "T9" "IEPOX test" "IEPOX ref"];
%Y = ["HCHO" "MVK" "GLYX" "MACR" "MGLY" "PANS" "MPANS" "IEPOX"];

for k = 1:Lr
    %P = ["MECH" "ISOP" "HCHO" "MVK" "GLYX" "MACR" "MGLY" "PANS" "ISOPN" "MPANS" "IEPOX"];
    %Y = ["T2" "T3" "T4" "T5" "T6" "T7" "T8" "T9" "IEPOX test" "IEPOX ref"];
    if k == 1
        ChemFiles = {...
            'cb6r3_ae7_aq_K(Met)';
            'cb6r3_ae7_aq_J(Met,1)';
            runs(k);
            };
    else
        ChemFiles = {...
            'F0AM_isop_K_update(Met)';
            'F0AM_isop_J(Met,1)';
            runs(k);
            };
    end
    for jj = 1:1
            %j = samples_to_read(jj)
            Met = {...
%  		names       values          
    		'P'         1000          ; %Pressure, mbar
    		'T'         292                ; %Temperature, K
    		'RH'        0                ; %Relative Humidity, percent
    		'LFlux'     'ExampleLightFlux.txt'     ; %Text file for radiation spectrum
            'SUN'       0.5             ;
    		'jcorr'     0.5              ; %light attenuation factor
    		};
        InitConc = {...
%   		names       conc(ppb)           HoldMe
        	'O2'        210000000             1;
        	'ISOP'      10          0;
        	'NO3'       0.0         0;
    		'HO'        0         0; %10^6 molecules per CC
    		'HO2'       0         0;
    		'NO'        0          0;
        	'NO2'       5         0;
        	'H2O2'      200         0;
            'O3'        0         0;
         %OH source option #1	
        	};
        BkgdConc = {...
%   names           values
        'DEFAULT'       0;   %0 for all zeros, 1 to use InitConc
        };

      
        ModelOptions.Verbose       = 3;
        ModelOptions.EndPointsOnly = 0;
        ModelOptions.LinkSteps     = 0;
        ModelOptions.IntTime       = 24*3600;
        ModelOptions.SavePath      = 'ChamberExampleOutput.mat';
        ModelOptions.GoParallel    = 0;
        x = F0AM_ModelCore(Met,InitConc,ChemFiles,BkgdConc,ModelOptions);
        S = [S x];
        
    end
end
m_hcho = Max_calc(S(2),"HCHO");
m_iepox = Max_calc(S(2),iep1);
m_isopn = Max_calc(S(2),org_nit);
m_gly = Max_calc(S(2),"GLY");
m_o3 = Max_calc(S(2),"O3");

m = [m_hcho,m_iepox,m_isopn,m_gly,m_o3];

ft_cb3 = Fitness_3(S(2),S(1),iep1,"EPOX",org_nit,"NTR2");
ft_amore = Fitness_3(S(2),S(3),iep1,"IEPOX",org_nit,"ISOPN");
ft_caltech = Fitness_3(S(2),S(4),iep1,iep2,org_nit,nit_2);
ft_cracmm = Fitness_3(S(2),S(5),iep1,"IEPOX",org_nit,"ISOPN");

%PlotConc('HO2',{S(1),S(2),S(3)},'lnames',{'CalTech','AMORE','CRACMM'})
